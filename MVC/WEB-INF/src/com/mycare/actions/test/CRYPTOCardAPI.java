package com.mycare.actions.test;

import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.io.ByteArrayInputStream;
import javax.imageio.ImageIO;

public class CRYPTOCardAPI
{
  public final int AUTH_FAILURE = 0;
  public final int AUTH_SUCCESS = 1;
  public final int CHALLENGE = 2;
  public final int SERVER_PIN_PROVIDED = 3;
  public final int USER_PIN_CHANGE = 4;
  public final int OUTER_WINDOW_AUTH = 5;
  public final int CHANGE_STATIC_PASSWORD = 6;
  public final int STATIC_CHANGE_FAILED = 7;
  public final int PIN_CHANGE_FAILED = 8;
  private static int m_IsInitialized = 0;

  private static final CRYPTOCardAPI INSTANCE = new CRYPTOCardAPI();

  public void LoadJNILibrary()
    throws UnsatisfiedLinkError, Exception
  {
    if (m_IsInitialized == 1) return;

    String LinuxLibPath = "JCryptoWrapper";
    String WindowsLibPath = "JCryptoWrapperWin";

    String osName = System.getProperty("os.name");
    String osLoadLib;    
    if (osName.toLowerCase().contains("windows"))
    {
      osLoadLib = WindowsLibPath;
    }
    else
    {
      osLoadLib = LinuxLibPath;
    }
    System.loadLibrary(osLoadLib);

    int iInit = Initialize();
    if (iInit == 0)
    {
      throw new Exception(String.format("CRYPTOCard -> LoadJNILibrary -> Initialize -> Lib [%s]. Initialize Failed", new Object[] { osLoadLib }));
    }

    m_IsInitialized = 1;
  }

  public void LoadJNILibrary(String LoadFromLocation)
    throws UnsatisfiedLinkError, Exception
  {
    if (m_IsInitialized == 1) return;

    System.load(LoadFromLocation);

    int iInit = Initialize();
    if (iInit == 0)
    {
      throw new Exception(String.format("CRYPTOCard -> LoadJNILibrary -> Initialize -> Lib [%s]. Initialize Failed", new Object[] { LoadFromLocation }));
    }

    m_IsInitialized = 1;
  }

  private native int Initialize();

  public static CRYPTOCardAPI getInstance()
  {
    m_IsInitialized = 0;
    return INSTANCE;
  }

  public native void Authenticate(String[] paramArrayOfString);

  public native void VerifySignature(String[] paramArrayOfString);

  public BufferedImage getGridSureGrid(String BSIDChallenge)
    throws Exception
  {
    if (BSIDChallenge == null)
    {
      throw new Exception("Challenge data can not be null");
    }

    if (BSIDChallenge.isEmpty())
    {
      throw new Exception("Challenge data can not be empty");
    }

    if (BSIDChallenge.length() < 25)
    {
      throw new Exception("Invalid challenge data. Min length for 5*5 grid is 25");
    }

    int defaultCellSize = 40;
    int defaultFontSize = 28;
    int defaultFontWidth = 18;

    int gridSize = (int)Math.sqrt(BSIDChallenge.length());

    int cellSize = defaultCellSize;
    int borderSize = 1;
    int halfBorder = borderSize / 2;

    int size = cellSize * gridSize + borderSize * (gridSize + 1);

    BufferedImage image = new BufferedImage(size, size, 1);
    Graphics gr = image.getGraphics();

    Font f = new Font("SansSerif", 0, defaultFontSize);
    gr.setFont(f);

    gr.setColor(Color.white);
    gr.drawRect(0, 0, size, size);
    gr.fillRect(0, 0, size, size);

    gr.setColor(Color.black);

    for (int i = 0; i < gridSize + 1; i++)
    {
      gr.drawLine(0, i * (cellSize + borderSize) + halfBorder, size, i * (cellSize + borderSize) + halfBorder);
      gr.drawLine(i * (cellSize + borderSize) + halfBorder, size, i * (cellSize + borderSize) + halfBorder, 0);
    }

    for (int i = 0; i < BSIDChallenge.length(); i++)
    {
      String cha = BSIDChallenge.substring(i, i + 1);
      int x = i % gridSize * (cellSize + borderSize) + cellSize / 2 - defaultFontWidth / 2 + borderSize;
      int y = i / gridSize * (cellSize + borderSize) + cellSize / 2 + defaultFontSize / 2 + borderSize - 3;
      gr.drawString(cha, x, y);
    }
    return image;
  }

  public BufferedImage getGridSureLogo()
    throws Exception
  {
    String logo = "Qk3WSQAAAAAAADYAAAAoAAAApQAAACYAAAABABgAAAAAAAAAAADEDgAAxA4AAAAAAAAAAAAA////////////////6/f+teX+atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/atL/teX++P3+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP///////////7Xl/mrS/zC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59mrS/7Xl/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD///////+15f4wufYwufZMirhvS197MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDpvS19MirgwufYwufa15f7////////9/Pz///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A+P3+teX+MLn2MLn2b0tfhQwMhQwMihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXhQwMhQwMb0tfMLn2MLn2teX+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AOv3/jC59jC59m9LX4UMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4UMDG9LXzC59mrS/+v3/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wC15f4wufZMiriFDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyFDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAxMirgwufa15f7////////9/Pz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/Pz////////////////////////////////////////////////////////////////9/Pz///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AatL/MLn2ezA6hQwMihgXihgXihgXihgXihgXhQwMhiIlb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfb0tfezA6ihgXihgXihgXihgXihgXihgXhQwMb0tfMLn2atL//////////////////////////////////////////fz8/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////fz8/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////fz8////////////////////////////////////////////////////////////AGrS/zC59oYiJYoYF4oYF4oYF4oYF4oYF4oYF29LX0yKuDC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59kyKuHswOoUMDIoYF4oYF4oYF4UMDHswOjC59mrS//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////j9/v////////////38/P////////////////////////////////j9/v////////////////////////////////////////////////////////////////////j9/v////////////////////////////38/P////////38/P///////////////////////////////wBq0v9MiriGIiWKGBeKGBeKGBeKGBeKGBdMirgwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufZ7MDqFDAyKGBeKGBeKGBeGIiUwufZq0v/////////////////////////////////////////////4/f7////////////////9/Pz////////////////////////////////////////////////////////////////////////////4/f7////////////////////////////////////////////////////////////////////////4/f7////////////////////////////////////////////////////////////////////////////////////////////9/Pz///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AatL/TIq4hiIlihgXihgXihgXhQwMb0tfMLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2TIq4hiIlihgXihgXihgXhiIlMLn2atL//////////////////////////////fz8/////////////////////////////////////////////////////////////////////////////////////////fz8/////////////////////////fz8/////////////////////////////////////fz8/////////////////////////////////////////////////////////////////fz8/////////////////////////fz8/////////////////////////////////////////////////////////////////////////////////////////////////////////fz8/////////////fz8////////////////////////////////////////////////////////////////////////////////////////////////////AGrS/0yKuIYiJYoYF4oYF4UMDIYiJTC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59m9LX4UMDIoYF4oYF4YiJTC59mrS//////////////////////////////////////////////////////////////////////////////////////////38/P////////////////////////////////////////////////////////////////////j9/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////j9/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBq0v9MiriGIiWKGBeKGBeFDAxvS18wufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufZMiriKGBeKGBeKGBeGIiUwufZq0v/////////////////////////////////59PXfwcHDjIy8fn68fn68fn68fn68fn68fn68fn7DjIzXs7P48fH////////////9/PzXs7O8fn7DjIy8fn7Po6L48fH////////////////////////////Po6K8fn7DjIzDjIy8fn7Xs7P9/Pz////fwcG8fn7DjIzDjIzDjIzDjIzDjIzDjIzDjIzDjIzDjIzDjIzPo6LfwcH27e3////////9/Pz////////////59PXXs7PDjIy8fn68fn68fn68fn68fn7DjIzfwcH9/Pz////////////////4/f7fwcG8fn60bm60bm7DjIzw4+L9/PzDjIzDjIzDjIy8fn7fwcH////48fHPo6K8fn7DjIy8fn7Xs7P////////////////////////////////9/Pz////m0M/Po6K8fn60bm68fn68fn68fn7DjIzfwcH9/Pz///////////////////////8AatL/TIq4hiIlihgXihgXhQwMTIq4MLn2MLn2MLn2MLn2TIq4hiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlb0tfMLn2MLn2MLn2MLn2MLn2hiIlihgXihgXhiIlMLn2atL/////////////////////////////38HBoEhIihgXhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXoEhI17Oz/////////fz8qVpahQwMhQwMhQwMlTEy8OPi////////////////////////////oEhIhQwMhQwMhQwMhQwMtG5u/fz8////w4yMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXihgXlTEyw4yM+PHx////////////6tjXoEhIihgXhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXqVpa8ubm/////////fz8vH5+ihgXhQwMhQwMhQwMhQwMlTEy17OzlTEyhQwMhQwMhQwMvH5+////8OPilTEyhQwMhQwMhQwMtG5u////////////////////////////////+/j4vH5+hiIlhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXtG5u+PHx////////////////////AGrS/0yKuIYiJYoYF4oYF4UMDEyKuDC59jC59jC59jC59m9LX4UMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4UMDIYiJUyKuDC59jC59jC59jC59oYiJYoYF4oYF4YiJTC59mrS/////////////////////////9/BwYYiJYUMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4UMDIYiJd/Bwf////38/KlaWoUMDIoYF4UMDJUxMvLm5v///////////////////////////6BISIUMDIoYF4oYF4UMDLRubv///////8OMjIUMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4UMDIUMDKlaWvjx8f////38/KlaWoUMDIoYF4oYF4oYF4UMDIUMDIUMDIUMDIoYF4oYF4UMDKlaWv38/P///8+jooUMDIUMDIoYF4oYF4UMDIUMDIUMDJUxMpUxMoUMDIoYF4UMDLx+fv////Lm5qBISIUMDIoYF4UMDLRubv///////////////////////////////8OMjIUMDIUMDIoYF4UMDIUMDIUMDIUMDIoYF4oYF4oYF4UMDMOMjP38/P///////////////wBq0v9MiriKGBeFDAyKGBeFDAxMirgwufYwufYwufYwufZvS1+FDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAyKGBdMirgwufYwufYwufYwufaGIiWKGBeKGBeGIiUwufZq0v/////////////////////27e2gSEiFDAyKGBeKGBeKGBeKGBeFDAyFDAyFDAyFDAyFDAyKGBeKGBeKGBeKGBeFDAypWlr7+Pj9/PypWlqFDAyKGBeFDAygSEjw4+L////////////////////////9/PypWlqFDAyKGBeKGBeFDAy0bm79/Pz////DjIyFDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAzDjIz////q2NeGIiWFDAyFDAyFDAyGIiW0bm68fn68fn6gSEiKGBeKGBeKGBeKGBfm0M////+0bm6FDAyKGBeKGBeKGBeKGBeVMTKGIiWFDAyKGBeKGBeKGBeFDAy8fn7////y5uagSEiFDAyKGBeFDAy0bm7////////////////////////////v4N+VMTKFDAyKGBeKGBeGIiWpWlq0bm6pWlqKGBeFDAyKGBeFDAygSEj48fH///////////////8AatL/TIq4hiIlihgXihgXihgXTIq4MLn2MLn2MLn2MLn2b0tfihgXhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlhiIlihgXhiIlTIq4MLn2MLn2MLn2MLn2hiIlihgXihgXhiIlMLn2atL/////////////////////17OzhQwMihgXihgXihgXihgXhQwMhiIllTEylTEylTEyhiIlhQwMihgXihgXihgXhQwMhiIl6tjX////qVpahQwMihgXhQwMoEhI8OPi////////////////////////////qVpahQwMihgXihgXhQwMtG5u/fz8////w4yMhQwMihgXihgXihgXihgXhQwMhQwMhQwMhQwMhQwMhQwMihgXihgXihgXihgXhQwMlTEy9u3t6tjXlTEyhiIllTEyhiIlw4yM////////////7+DflTEyhQwMihgXihgXz6Oi/fz8qVpahQwMihgXihgXhiIlz6Oi8OPi38HBqVpahQwMihgXihgXhQwMvH5+////8ubmoEhIhQwMihgXhQwMtG5u////////////////////////////38HBihgXhQwMihgXihgXvH5++/j4////+PHxqVpahQwMihgXhQwMlTEy9u3t////////////////AGrS/zC59kyKuEyKuEyKuEyKuDC59jC59jC59jC59jC59kyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuDC59jC59jC59jC59jC59oYiJYoYF4oYF4YiJTC59mrS//////////////////38/Lx+foUMDIoYF4oYF4oYF4oYF7RububQz/Dj4vDj4vDj4t/BwalaWoUMDIoYF4oYF4oYF4oYF9ezs////6laWoUMDIoYF4UMDKBISPLm5v///////////////////////////6BISIUMDIoYF4oYF4UMDLRubv38/P///8OMjIUMDIoYF4oYF4UMDKBISNezs9/Bwdezs9/Bwd/Bwbx+fooYF4oYF4oYF4oYF4UMDIoYF9/Bwfv4+OrY1+rY1+/g3+rY1/Dj4vLm5vLm5urY18+jooYiJYoYF4oYF4oYF8+jov38/KBISIUMDIoYF4UMDKBISP38/P///////+bQz4oYF4oYF4oYF4UMDLx+fv////Lm5qBISIUMDIoYF4UMDLRubv///////////////////////////9ezs4oYF4UMDIUMDIYiJebQz/////////////Lm5t/Bwd/Bwd/Bwd/Bwfv4+P///////////////wBq0v8wufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufaGIiWKGBeKGBeGIiUwufZq0v/////////////////7+PipWlqFDAyKGBeKGBeKGBeVMTLy5ub////////////////////m0M+GIiWFDAyKGBeKGBeKGBfPo6L///+pWlqFDAyKGBeFDAygSEjw4+L////////////////////4/f7///+pWlqFDAyKGBeKGBeFDAy0bm79/Pz////DjIyFDAyKGBeKGBeFDAypWlr////////////////////9/Py8fn6FDAyKGBeKGBeFDAyKGBfXs7P////////m0M+8fn6pWlqgSEiVMTKVMTKVMTKGIiWKGBeKGBeKGBeKGBffwcH7+PigSEiFDAyKGBeFDAypWlr7+Pj////////v4N+GIiWKGBeKGBeFDAy8fn7////y5uagSEiFDAyKGBeFDAy0bm7////////////////////////////Xs7OKGBeFDAyKGBeGIiXDjIzXs7PXs7PXs7PfwcHfwcHfwcHfwcHfwcH7+Pj///////////////8AatL/MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2hiIlihgXihgXhiIlMLn2atL/////////////////+/j4qVpahQwMihgXihgXhQwMoEhI/fz8////////+/j4+/j4+/j46tjXlTEyhQwMihgXihgXihgX17Oz////qVpahQwMihgXhQwMlTEy8OPi/////fz8/fz8/fz8/fz8////////qVpahQwMihgXihgXhQwMtG5u/fz8////w4yMhQwMihgXihgXhQwMoEhI+fT1////////////////////38HBhiIlhQwMihgXihgXhQwMz6Oi////17OzhiIlhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXhQwMhQwMlTEy+PHx+fT1oEhIhQwMihgXhQwMqVpa/fz8////////8ubmlTEyihgXihgXhQwMvH5+////8ubmoEhIhQwMihgXhQwMtG5u/fz8/////////fz8/fz8/fz8////z6OihQwMihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXhQwMlTEy7+Df////////////////AGrS/zC59kyKuEyKuEyKuEyKuDC59jC59jC59jC59jC59kyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuEyKuIYiJYoYF4oYF4YiJTC59mrS//////////////////n09aBISIUMDIoYF4oYF4UMDKlaWv///////////8OMjKBISKlaWqBISIYiJYoYF4oYF4oYF4oYF9ezs////6laWoUMDIoYF4UMDKBISPLm5v///+rY17x+frx+frx+fs+jovv4+KlaWoUMDIoYF4oYF4UMDLRubv///////8OMjIUMDIoYF4oYF4UMDKBISPn09f////////38/P///////+bQz4YiJYUMDIoYF4oYF4UMDM+jov38/KBISIUMDIoYF4oYF4UMDIUMDIUMDIoYF4oYF4oYF4YiJaBISN/Bwf////jx8aBISIUMDIoYF4UMDKlaWv38/P////////Lm5pUxMooYF4oYF4UMDLx+fv////Lm5qBISIUMDIoYF4UMDLRubv///////9/Bwbx+frx+frx+ft/Bwc+jooUMDIoYF4oYF4oYF4oYF4UMDIUMDIUMDIoYF4oYF4oYF4UMDIYiJe/g3////////////////wBq0v9MiriGIiWKGBeKGBeFDAxMirgwufYwufYwufYwufZvS1+FDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeGIiUwufZq0v/////////////////59PWgSEiFDAyKGBeKGBeFDAypWlr///////////+pWlqFDAyFDAyFDAyKGBeKGBeKGBeKGBeKGBfXs7P///+pWlqFDAyKGBeFDAygSEj27e3////Po6KFDAyFDAyFDAygSEj59PWpWlqFDAyKGBeKGBeFDAy0bm79/Pz////DjIyFDAyKGBeKGBeFDAygSEj59PX////////////////////q2NeVMTKFDAyKGBeKGBeFDAzPo6L48fGVMTKKGBeKGBeKGBegSEi8fn68fn7DjIzPo6LfwcHq2Nf////////////48fGgSEiFDAyKGBeFDAypWlr9/Pz////////w4+KVMTKKGBeKGBeFDAy8fn7////y5uagSEiFDAyKGBeFDAypWlr///////+8fn6FDAyFDAyFDAy8fn7fwcGKGBeKGBeKGBeKGBe0bm7Po6LDjIzPo6K0bm6FDAyKGBeFDAyVMTLy5ub///////////////8AatL/TIq4hiIlihgXihgXhQwMTIq4MLn2MLn2MLn2MLn2b0tfhQwMihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXhiIlMLn2atL/////////////////+fT1oEhIhQwMihgXihgXhQwMqVpa////////////qVpahQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMz6Oi////qVpahQwMihgXhQwMhiIl17Oz////w4yMhQwMihgXhQwMqVpa+/j4qVpahQwMihgXihgXhQwMtG5u/fz8////w4yMhQwMihgXihgXhQwMoEhI+fT1////////////////////7+DflTEyhQwMihgXihgXhQwMz6Oi9u3thiIlihgXihgXhQwM17Oz////////////5tDPw4yMz6Oiw4yM17Oz////+PHxoEhIhQwMihgXhQwMqVpa/fz8////////8ubmlTEyihgXihgXhQwMvH5+////8ubmoEhIhQwMihgXihgXlTEy6tjX+/j4qVpahQwMihgXhQwMw4yM38HBihgXhQwMihgXihgX17Oz/////fz8////w4yMhQwMihgXhQwMlTEy+PHx////////////////AGrS/0yKuIYiJYoYF4oYF4UMDEyKuDC59jC59jC59jC59m9LX4UMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4YiJTC59mrS//////////////////v4+KlaWoUMDIoYF4oYF4UMDKlaWv///////////7RuboYiJZUxMpUxMpUxMpUxMpUxMpUxMpUxMtezs////6laWoUMDIoYF4oYF4UMDJUxMqlaWpUxMooYF4oYF4UMDLRubv38/KlaWoUMDIoYF4oYF4UMDLRubv38/P///8OMjIUMDIoYF4oYF4UMDKBISPn09f///////////////////+/g35UxMoUMDIoYF4oYF4UMDM+jovjx8ZUxMooYF4oYF4UMDKlaWtezs9/Bwc+jopUxMoUMDIUMDIUMDKBISP////n09aBISIUMDIoYF4UMDKlaWv38/P////////Dj4pUxMoUMDIoYF4UMDLx+fv////Lm5qBISIUMDIoYF4oYF4UMDJUxMqlaWoYiJYoYF4oYF4UMDMOMjPLm5pUxMoUMDIoYF4oYF5UxMrx+fsOMjLRuboYiJYoYF4oYF4UMDLRubvv4+P///////////////wBq0v9MiriGIiWKGBeKGBeFDAxMirgwufYwufYwufYwufZvS1+FDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeGIiUwufZq0v/////////////////7+PipWlqFDAyKGBeKGBeFDAypWlr////////////y5ubv4N/v4N/v4N/v4N/v4N/v4N/v4N/v4N/59PX9/PypWlqFDAyKGBeKGBeGIiWFDAyFDAyKGBeKGBeKGBeFDAzDjIz///+pWlqFDAyKGBeKGBeFDAy0bm7////////DjIyFDAyKGBeKGBeFDAygSEj59PX////////////////////m0M+VMTKFDAyKGBeKGBeFDAzPo6L9/PypWlqFDAyKGBeKGBeKGBeKGBeKGBeKGBeFDAyKGBeKGBeFDAy8fn7////48fGgSEiFDAyKGBeFDAypWlr9/Pz////////w4+KVMTKFDAyKGBeFDAy8fn7////y5uagSEiFDAyKGBeKGBeGIiWFDAyFDAyKGBeKGBeKGBeFDAzPo6L///+0bm6FDAyKGBeKGBeKGBeFDAyFDAyFDAyKGBeKGBeFDAyFDAzXs7P///////////////////8AatL/TIq4hiIlihgXihgXhQwMTIq4MLn2MLn2MLn2MLn2b0tfhQwMihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXihgXb0tfTIq4TIq4TIq4b0tfhiIlihgXihgXhiIlMLn2atL/////////////////+/j4qVpahQwMihgXihgXhQwMqVpa/////////////////////////////////////fz8/////////////fz8qVpahQwMhQwMhQwMoEhIqVpahQwMhQwMhQwMhQwMhiIl5tDP////qVpahQwMihgXihgXhQwMtG5u/fz8////w4yMhQwMihgXihgXhQwMoEhI+fT1////////////////////5tDPhiIlhQwMihgXihgXhQwMz6Oi////38HBhiIlhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMoEhI7+Df////+PHxoEhIhQwMhQwMhQwMoEhI/fz8////////8ubmhiIlhQwMhQwMhQwMvH5+////8OPilTEyhQwMhQwMhQwMqVpaoEhIhQwMhQwMhQwMhQwMoEhI8ubm////7+DfqVpahQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXw4yM////////////////////////AGrS/0yKuIYiJYoYF4oYF4UMDEyKuDC59jC59jC59jC59m9LX4UMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIUMDIYiJTC59jC59jC59jC59jC59oYiJYoYF4oYF4YiJTC59mrS//////////////////38/LRuboUMDIoYF4oYF4UMDJUxMvjx8f////////////////////Dj4rRubrRubrRubrRubrRubt/Bwf///8OMjKBISKlaWqBISLx+fvDj4sOMjKBISKBISKlaWt/Bwf///////6laWoUMDIoYF4oYF4UMDLRubv38/P///8OMjIUMDIoYF4oYF4UMDKlaWv///////////////////////8+joooYF4oYF4oYF4oYF4UMDM+jov///////+bQz8OMjLRubqBISKBISKBISKBISKBISLRubsOMjPDj4v////////n09bx+fqBISKlaWqlaWsOMjP38/P////////bt7bRubqlaWqlaWqBISM+jov////bt7bx+fqBISKlaWqlaWs+jou/g37RubqBISKBISLRuburY1/////38/P////jx8c+jorRubqlaWqBISKBISKBISKlaWrRubt/Bwf////v4+OrY1+bQz/bt7f///////wBq0v9MiriGIiWKGBeKGBeFDAxMirgwufYwufYwufYwufZMirhvS19vS19vS19vS19vS19vS19vS19vS19vS19vS19vS19vS19vS19MirgwufYwufYwufYwufZMiriGIiWKGBeKGBeGIiUwufZq0v/////////////////9/Py8fn6FDAyKGBeKGBeKGBeKGBe8fn7y5ub9/Pz9/Pz9/Pz27e28fn6FDAyFDAyFDAyFDAyFDAzXs7P////9/Pz9/Pz9/Pz////9/Pz////9/Pz7+Pj59PX///////////////+pWlqFDAyKGBeKGBeFDAy0bm7////////DjIyFDAyKGBeKGBeFDAygSEjm0M/q2Nfq2Nfq2Nfm0M/Xs7OVMTKFDAyKGBeKGBeFDAyKGBfXs7P////9/Pz////////////7+Pj59PX59PX59PX7+Pj////////////////////////9/Pz9/Pz9/Pz9/Pz9/Pz////////////////9/Pz9/Pz9/Pz9/Pz////////////////9/Pz9/Pz9/Pz9/Pz////////59PX59PX////////////4/f7////////////////7+Pj59PX59PX59PX9/Pz////9/Pz59PXDjIzDjIzPo6K8fn7w4+L///8AatL/TIq4hiIlihgXihgXhQwMb0tfMLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2TIq4hQwMihgXihgXhiIlMLn2atL/////////////////////17OzhQwMihgXihgXihgXihgXihgXoEhIqVpaqVpaqVpaoEhIihgXihgXihgXihgXihgXhiIl5tDP////////////////////////////////////////////////////////qVpahQwMihgXihgXhQwMtG5u/fz8////w4yMhQwMihgXihgXihgXhiIllTEylTEylTEylTEylTEyihgXhQwMihgXihgXihgXhQwMlTEy6tjX////////////////////////////////////////////////+P3+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////17OzvH5+w4yMz6Oiw4yMz6Oi/fz8AGrS/0yKuIYiJYoYF4oYF4oYF4YiJUyKuDC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59m9LX4oYF4oYF4oYF4YiJTC59mrS//////////////////////Lm5qBISIUMDIoYF4oYF4oYF4oYF4UMDIUMDIUMDIUMDIUMDIoYF4oYF4oYF4oYF4UMDKBISPjx8f////////////////////////////j9/v///////////////////////6laWoUMDIoYF4oYF4UMDLRubv///////8OMjIUMDIoYF4oYF4oYF4oYF4UMDIUMDIUMDIUMDIUMDIoYF4oYF4oYF4oYF4oYF4UMDLRubv////////////////////////////////////////////////////////////////////////////38/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8+jos+jorRubrRubtezs8+jovv4+ABq0v9MiriGIiWKGBeKGBeKGBeFDAxvS18wufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufYwufZMiriKGBeKGBeKGBeKGBeGIiUwufZq0v/////////////////////////Xs7OKGBeFDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAzDjIz///////////////////////////////////////////////////////////+pWlqFDAyKGBeKGBeFDAy0bm79/Pz////DjIyFDAyKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeKGBeFDAygSEjw4+L////////////4/f7////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////q2Ne8fn68fn7DjIy8fn7Xs7P///8AatL/MLn2hiIlihgXihgXihgXihgXihgXb0tfMLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2TIq4ihgXihgXihgXihgXhQwMezA6MLn2atL/////////////////////////////17OzlTEyhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXvH5++/j4////////+P3+////////////////////////////////////////////////oEhIhQwMhQwMhQwMhQwMqVpa/fz8////w4yMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXqVpa6tjX////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////38HBw4yMw4yM17Oz/fz8////AGrS/zC59nswOoUMDIoYF4oYF4oYF4oYF4UMDHswOkyKuEyKuDC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59jC59kyKuG9LX4oYF4oYF4oYF4oYF4oYF4UMDG9LXzC59mrS//////////////////////////////////bt7c+jorRubqlaWqBISKBISKBISKBISKBISKBISKlaWrx+ftezs////////////////////////////////////////////////////////////////////7x+fqlaWqlaWqlaWqlaWsOMjP///////9ezs6BISKlaWqlaWqlaWqlaWqlaWqlaWqlaWqlaWqlaWqlaWrRubsOMjN/Bwfv4+P////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////38/P////////////////v4+Pn09f///////////wC15f4wufZMiriFDAyKGBeKGBeKGBeKGBeKGBeFDAyFDAyGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWGIiWKGBeFDAyKGBeKGBeKGBeKGBeKGBeFDAxMirgwufa15f7////////////////////////////9/Pz////////4/f77+Pj48fH48fH27e348fH27e348fH9/Pz////////////////9/Pz////////////////////////////////////////////////////////9/Pz7+Pj9/Pz9/Pz7+Pj9/Pz////////9/Pz7+Pj7+Pj9/Pz9/Pz7+Pj9/Pz7+Pj9/Pz9/Pz7+Pj9/Pz///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A6/f+atL/MLn2b0tfhQwMihgXihgXihgXihgXihgXihgXihgXihgXhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMhQwMihgXihgXihgXihgXihgXihgXhQwMb0tfMLn2atL/+P3+/////////////////////////fz8/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////fz8AP///7Xl/jC59jC59m9LX4UMDIUMDIoYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4oYF4UMDIUMDIoYF29LXzC59jC59rXl/vj9/v////////////////////////////////////////////////////////////////////////////j9/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD///////+15f4wufYwufZMirhvS197MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDp7MDpvS19MirgwufYwufa15f7////////4/f7////////////////4/f7////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/Pz///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A////////////teX+atL/MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2MLn2atL/teX+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////j9/rXl/rXl/mrS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/2rS/7Xl/rXl/vj9/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wA=";
    BASE64Decoder decoder = new BASE64Decoder();
    BufferedImage image = null;
    try
    {
      byte[] bufferData = decoder.decodeBuffer(logo);
      if (bufferData.length > 0)
      {
        image = ImageIO.read(new ByteArrayInputStream(bufferData));
      }
    }
    catch (Exception ex)
    {
      throw ex;
    }

    return image;
  }
}